{% extends "layout.html" %}

{% block content_header %}
  {{ build_breadcrumb('Plugins', '', 'cubes', ['List']) }}
{% endblock %}

{% block content %}

  {% set market = [
    ('user', 'Users', 'aqua', ['beta', 'users', 'tag1', 'tag2'], False, True, 'https://github.com/wazo-pbx/wazo-admin-ui-user', 'François Blackburn'),
    ('users', 'Groups', 'aqua', ['beta', 'users'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-group', 'Sylvain Boily'),
    ('compress', 'Conferences', 'yellow', ['beta', 'application'], True, False, 'https://github.com/wazo-pbx/wazo-admin-ui-conference'),
    ('automobile', 'Parking', 'yellow', ['beta', 'application'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-parking-lot'),
    ('desktop', 'Switchboard', 'yellow', ['beta', 'application'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-switchboard'),
    ('envelope', 'Voicemail', 'yellow', ['beta', 'application'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-voicemail'),
    ('newspaper-o', 'CDR', 'yellow', ['beta', 'application'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-cdr'),
    ('long-arrow-right', 'Incalls', 'green', ['beta', 'routing'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-incall'),
    ('long-arrow-left', 'Outcalls', 'green', ['beta', 'routing'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-outcall'),
    ('bullhorn', 'Paging', 'yellow', ['beta', 'application'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-paging'),
    ('music', 'Moh', 'yellow', ['beta', 'application'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-moh'),
    ('server', 'Trunks', 'green', ['beta', 'routing'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-trunk'),
    ('gears', 'Extensions', 'red', ['beta', 'internal'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-extension'),
    ('gears', 'Context', 'red', ['beta', 'internal'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-context'),
    ('navicon', 'IVR', 'yellow', ['beta', 'application'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-ivr'),
    ('gear', 'Devices', 'red', ['beta', 'internal'], False, False, 'https://github.com/wazo-pbx/wazo-admin-ui-device'),
    ]
  %}

  <section class="content">
    <div class="row">
      <div class="col-md-12">
        <div class="nav-tabs-custom">
          <ul class="nav nav-tabs">
            <li class="active"><a href="#market" data-toggle="tab">Market</a></li>
            <li><a href="#git" data-toggle="tab">Git</a></li>
          </ul>
          <div class="tab-content">

            <div class="tab-pane active" id="market">
              <div class="row">
                <div class="col-md-2 pull-right">
                  <div class="input-group">
                    <input class="form-control" placeholder="Search plugin" type="text">
                    <span class="input-group-addon">
                      <i class="fa fa-search"></i>
                    </span>
                  </div>
                </div>
                <div class="col-md-2 pull-right">
                  <div class="form-group">
                    <select class="form-control">
                      <option>All</option>
                      <option>Installed</option>
                      <option>Not installed</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="row">
                {% for m in market %}
                  {{ _render_plugin(m[0], m[1], m[2], m[3], m[4], m[5], m[6], m[7]) }}
                {% endfor %}
              </div>
            </div>

            <div class="tab-pane" id="git">
              <div class="row">
                <div class="col-md-4">
                  <h4>Give your GIT url to install a plugin!</h4>
                  <div class="input-group">
                    <span class="input-group-addon">
                      <i class="fa fa-download"></i>
                    </span>
                    <input class="form-control" placeholder="GIT url..." type="text">
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-primary btn-flat">Install</button>
                      </span>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </section>
{% endblock %}

{% macro _render_plugin(icon, name, color, tags, loading, is_installed, url, author) %}
  <div class="col-md-3 col-sm-6 col-xs-12">
    <div class="small-box bg-{{ color }} box box-solid">
      <div class="inner">
        <h3>{{ name }}</h3>
        <p>By {{ author or 'Wazo Team' }}</p>
        {{ _render_tags(tags) }}
        {{ _render_button(is_installed|default(False), name, url|default(name)) }}
      </div>
      <div class="icon">
        <i class="fa fa-{{ icon }}"></i>
      </div>
      <a href="{{ url or '#' }}" class="small-box-footer" target="_blank">
        More info <i class="fa fa-arrow-circle-right"></i>
      </a>
      <div class="overlay {% if not loading %}hidden{% endif %}" id="{{ name }}">
        <i class="fa fa-refresh fa-spin"></i>
      </div>
    </div>
  </div>
{% endmacro %}

{% macro _render_tags(tags) %}
  {% for tag in tags %}
    <span>
      <small class="label label-default">
        <i class="fa fa-tag"></i>
        {{ tag }}
      </small>
      &nbsp;
    </span>
  {% endfor %}
{% endmacro %}

{% macro _render_button(is_installed, name, url) %}
  <button type="button" class="btn btn-default btn-xs margin label" data-installed="{{ is_installed }}" data-name="{{ name }}" data-url="{{ url }}">
  {% if is_installed %}
    Remove
    <i class="fa fa-trash"></i>
  {% else %}
    Install
    <i class="fa fa-download"></i>
  {% endif %}
  </button>
{% endmacro %}

{% block additional_js %}
  <script src="{{ url_for('.static', filename='js/plugin.js') }}"></script>
{% endblock %}
